console.log("Last modification time: 3/7/2021, 6:07:31 PM"),function(e){function t(t){for(var i,a,c=t[0],s=t[1],d=t[2],u=0,f=[];u<c.length;u++)a=c[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(l&&l(t);f.length;)f.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={2:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="./";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var l=s;r.push([23,0]),n()}([,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a}));var i={"120p,120p_1":[160,120,15,65],"360p_4":[640,360,30,600],"480p_4":[640,480,30,750],"720p_3":[1280,720,30,1710]},o=1,r="06d344e526194d0cb27960ab9b38020c",a=null},function(e,t,n){"use strict";var i,o=n(1),r=n.n(o),a=(i=function(e,t){e instanceof Array?e.map((function(e){return t(e)})):t(e)},{hide:function(e){i(e,(function(e){r()(e).hide()}))},show:function(e){i(e,(function(e){r()(e).show()}))},toggle:function(e){i(e,(function(e){r()(e).toggle()}))},enable:function(e){i(e,(function(e){r()(e).removeClass("disabled")}))},disable:function(e){i(e,(function(e){r()(e).addClass("disabled")}))}});t.a=a},,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},o=function(){return window.innerWidth<=800&&window.innerHeight<=830},r=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},a=function(){return"undefined"!=typeof InstallTrigger}},,function(e,t,n){"use strict";n(26);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}t.a={init:function(e,t,n){this.MAX_RATIO=n,this.MIN_RATIO=t,this.canvas=document.querySelector("#".concat(e))},_checkRatio:function(e,t){var n=t/e;return!(n>this.MAX_RATIO||n<this.MIN_RATIO)},customRender:function(e,t,n){this.canvas.classList.remove("container__flex"),this.canvas.classList.add("container__grid");var i=e.length;n=n||e[e.length-1]&&e[e.length-1].getId(),i>4&&1===t||i>8?(t=0,console.log("Automatically switch to tile mode..."),this.rendererFactory(e,t,n)):this.rendererFactory(e,t,n)},rendererFactory:function(e,t,n){if(0===t)this.tileRenderer(e);else if(1===t)this.pipRenderer(e,n);else{if(2!==t)throw Error("Wrong mode for renderer");this.sharingRenderer(e,n)}},updateVideoItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.getId(),o=document.querySelector("#video-item-"+i);if(!o){o=document.createElement("section");var r=document.createElement("div");o.setAttribute("id","video-item-"+i),o.setAttribute("class","video-item"),r.setAttribute("class","video-item-box"),o.appendChild(r),this.canvas.appendChild(o),e.play("video-item-"+i,{fit:"contain"})}n?o.classList.add("window__fit"):o.classList.remove("window__fit"),o.setAttribute("style",t)},enterFullScreen:function(){this.canvas.classList.add("fullscreen")},exitFullScreen:function(){this.canvas.classList.remove("fullscreen")},tileRenderer:function(e){var t=function(e){for(var t,n,i,o,r,a=e.width,c=e.height,s=e.minRatio,d=e.maxRatio,l=e.count,u=1;u<=l;u++){var f=u,h=Math.ceil(l/u);n=Math.floor((a-5)/h);var m=(i=Math.floor((c-5)/f))/n;m>d?i=(m=d)*n:m<s&&(n=i/(m=s));var p=n*i*l;(void 0===t||p>t)&&(t=p,r=i,o=n)}return{height:r,width:o}}({width:this.canvas.clientWidth,height:this.canvas.clientHeight,minRatio:this.MIN_RATIO,maxRatio:this.MAX_RATIO,count:e.length}),n=t.width,i=t.height;this.canvas.classList.remove("container__grid"),this.canvas.classList.add("container__flex");var r,a=o(e);try{for(a.s();!(r=a.n()).done;){var c=r.value;this.updateVideoItem(c,"width: ".concat(n,"px; height: ").concat(i,"px;"))}}catch(e){a.e(e)}finally{a.f()}},pipRenderer:function(e,t){var n=e.length;if(n>4)throw Error("PIP mode only suitable for less than 4 stream");if(!this._checkRatio(4*this.canvas.clientWidth/24,3*this.canvas.clientHeight/12)||!this._checkRatio(12*this.canvas.clientWidth/24,12*this.canvas.clientHeight/12))return this.tileRenderer(e);for(var i=0,o=0;i<n;i++){var r=e[i];r.getId()===t?this.updateVideoItem(r,"grid-area: span 12/span 24/13/25"):(this.updateVideoItem(r,"grid-area: span 3/span 4/".concat(4+3*o,"/25;\n                    z-index:1;width:calc(100% - 20px);height:calc(100% - 20px)")),o++)}},sharingRenderer:function(e,t){var n=e.length;if(n>8)throw Error("Screen Sharing Mode only suitable for less than 8 stream");if(!this._checkRatio(4*this.canvas.clientWidth/24,4*this.canvas.clientHeight/12)&&1!==e.length){var r=e.findIndex((function(e){return e.getId()===t}));if(-1===r)throw Error("Cannot find stream by given mainId!");for(var a=0;a<n;a++)a!==r&&this.updateVideoItem(e[a],"display: none");return this.sharingRenderer([e[r]],t)}var c=i(e);if(8===n){var s=c.findIndex((function(e){return e.hasAudio()&&!e.hasVideo()}));-1===s&&(s=7);var d=c[s];this.updateVideoItem(d,"display: none"),c.splice(s,1)}var l,u=o(c);try{for(u.s();!(l=u.n()).done;){var f=l.value;f.getId()===t?1===n?this.updateVideoItem(f,"grid-area: span 12/span 24/13/25;",!0):n<5?this.updateVideoItem(f,"grid-area: span 12/span 20/13/25;",!0):this.updateVideoItem(f,"grid-area: span 12/span 16/13/21;",!0):this.updateVideoItem(f,"grid-area: span 4/span 4")}}catch(e){u.e(e)}finally{u.f()}}}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var i=function(e,t,n){console.log("%c ".concat(e,": ").concat(n),"color: ".concat(t))},o={init:function(e,t){return function(n){return i(e,t,n)}}}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,i=new Array(n);n--;)i[n]=[t[n],e[t[n]]];return i})},,,,,function(e,t,n){"use strict";var i=n(1),o=n.n(i),r=function(){var e=o()(".notification-container");e.length||(o()("body").append('<div class="notification-container" \n                    style="z-index: 12;position: absolute;\n                    width: 38.2%;max-width: 450px; \n                    min-width: 300px;left: 0;\n                    word-break:break-all;\n                    bottom: 0;"></div>'),e=o()(".notification-container"));var t=function(t,n,i){var r=(new Date).getTime(),a='<div id="notify-'.concat(r,'" class="notification is-').concat(t,'">\n                                <button class="delete"></button>\n                                ').concat(n,"\n                            </div>");e.append(a),o()("#notify-"+r+" .delete").on("click",(function(){o()("#notify-"+r).remove()})),setTimeout((function(){o()("#notify-"+r).remove()}),i)};return{primary:function(e,n){t("primary",e,n)},link:function(e,n){t("link",e,n)},info:function(e,n){t("info",e,n)},success:function(e,n){t("success",e,n)},warning:function(e,n){t("warning",e,n)},danger:function(e,n){t("danger",e,n)}}}();t.a=r},,,function(e,t,n){"use strict";n.r(t),function(e){var t=n(6),i=n.n(t),o=(n(17),n(1)),r=n.n(o),a=n(3),c=n(19),s=(n(13),n(14),n(25),n(5)),d=n(7),l=n(20),u=n(9),f=n(4),h=n(12),m=(n(15),n(16));n(27);function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw r}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}m.a.initializeApp({apiKey:"AIzaSyDOCwPfl_GsC-PKTDQmZxyAaBuvxnHDo7U",authDomain:"augmentedteaching-ea1ff.firebaseapp.com",databaseURL:"https://augmentedteaching-ea1ff-default-rtdb.firebaseio.com",projectId:"augmentedteaching-ea1ff",storageBucket:"augmentedteaching-ea1ff.appspot.com",messagingSenderId:"984963266408",appId:"1:984963266408:web:2f005bfe04d93b781188dd"});m.a.database();function v(e,t){m.a.database().ref("clicks/").push({offsetX:e,offsetY:t})}var b,y,w={},S={},I={},M=[],A=null,R=null,k=h.b.init("global","blue"),O=h.b.init("share","yellow"),_=h.b.init("local","green"),B=function(e,t){return new Promise((function(n,i){e.init(t.key,(function(){k("AgoraRTC client initialized");var o=f.b[t.videoProfileLow];e.join(t.token,t.channel,t.uid,(function(t){Object(h.a)(t,"brown","User ".concat(t," join channel successfully")),Object(h.a)(t,"brown",(new Date).toLocaleTimeString()),e.setLowStreamParameter({width:o[0],height:o[1],framerate:o[2],bitrate:o[3]}),n(t)}),(function(e){i(e)}))}))}))},T=function(e,t,n){var o={streamID:e,audio:!0,video:!0,screen:!1};switch(t.attendeeMode){case"audio-only":o.video=!1;break;case"audience":o.video=!1,o.audio=!1;break;default:case"video":}var r=i.a.createStream(Object(c.merge)(o,n));return r.setVideoProfile(t.videoProfile),r},j=function(){try{A&&A.unpublish(R),R&&R.close(),A&&A.leave((function(){O("Share client succeed to leave.")}),(function(){O("Share client failed to leave.")}))}finally{A=null,R=null}};window.installSuccess=function(){k.apply(void 0,arguments)},window.installError=function(){k.apply(void 0,arguments),l.a.danger("Failed to install the extension, please check the network and console.",3e3)};var x=function(e){M.map((function(t,n){return t.getId()===e?(M[n].close(),r()("#video-item-"+e).remove(),M.splice(n,1),1):0})),M.length<=4&&2!==w.displayMode&&s.a.enable(".displayModeBtn"),u.a.customRender(M,w.displayMode,b)},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getId(),i=M.some((function(e){return e.getId()===n}));i||(t?M.push(e):M.unshift(e),M.length>4&&(w.displayMode=1===w.displayMode?0:w.displayMode,s.a.disable([".displayModeBtn",".disableRemoteBtn"])),u.a.customRender(M,w.displayMode,b),r()("video").on("click",(function(e){var t=e.target.videoWidth/e.target.videoHeight;t>1?v((e.offsetX-e.target.offsetWidth/2)/e.target.offsetWidth,(e.offsetY-e.target.offsetHeight/2)/(e.target.offsetWidth/t)):v((e.offsetX-e.target.offsetWidth/2)/(e.target.offsetHeight*t),(e.offsetY-e.target.offsetHeight/2)/e.target.offsetHeight)})))},P=function(e){return M.filter((function(t){return t.getId()===e}))[0]},L=function(e,t){if(e!==t){var n,i,o,r=p(M);try{for(r.s();!(o=r.n()).done;){var a=o.value,c=a.getId();c===e?n=a:c===t&&(i=a)}}catch(e){r.e(e)}finally{r.f()}n&&S.setRemoteVideoStreamType(n,1),i&&S.setRemoteVideoStreamType(i,0)}};(function(e){switch(document.querySelector(".ag-header-lead span").innerHTML="AgoraWeb v".concat("^2.5.2".slice(1)),u.a.init("ag-canvas",9/16,1.6),Object(d.c)()&&u.a.enterFullScreen(),Object(d.b)()||Object(d.a)()||s.a.disable(".shareScreenBtn"),r()("#room-name").html(e.channel),e.attendeeMode){case"audio-only":s.a.hide([".videoControlBtn",".shareScreenBtn"]);break;case"audience":s.a.hide([".videoControlBtn",".audioControlBtn",".shareScreenBtn"]);break;default:case"video":}})(w=function(){var e={videoProfile:a.get("videoProfile").split(",")[0]||"480p_4",videoProfileLow:a.get("videoProfileLow"),cameraId:a.get("cameraId"),microphoneId:a.get("microphoneId"),channel:a.get("channel")||"test",transcode:a.get("transcode")||"interop",attendeeMode:a.get("attendeeMode")||"video",baseMode:a.get("baseMode")||"avc",displayMode:1,uid:void 0,resolution:void 0},t=f.b[a.get("videoProfile")];return e.resolution=t[0]/t[1]||4/3,e.key=f.a,e.token=f.d,e}()),S=i.a.createClient({mode:w.transcode}),r()(".displayModeBtn").on("click",(function(e){e.currentTarget.classList.contains("disabled")||M.length<=1||(1===w.displayMode?(w.displayMode=0,s.a.disable(".disableRemoteBtn")):0===w.displayMode&&(w.displayMode=1,s.a.enable(".disableRemoteBtn")),u.a.customRender(M,w.displayMode,b))})),r()(".exitBtn").on("click",(function(){try{A&&j(),S&&S.unpublish(I),I&&I.close(),S&&S.leave((function(){_("Client succeed to leave.")}),(function(){_("Client failed to leave.")}))}finally{window.location.href="index.html"}})),r()(".videoControlBtn").on("click",(function(){r()(".videoControlBtn").toggleClass("off"),I.isVideoOn()?I.disableVideo():I.enableVideo()})),r()(".audioControlBtn").on("click",(function(){r()(".audioControlBtn").toggleClass("off"),I.isAudioOn()?I.disableAudio():I.enableAudio()})),r()(".shareScreenBtn").on("click",(function(e){e.currentTarget.classList.contains("disabled")||(A?j():function(){s.a.disable(".shareScreenBtn"),A=i.a.createClient({mode:w.transcode});var e=Object(c.merge)(w,{uid:f.c});B(A,e).then((function(t){(R=T(t,e,{screen:!0,video:!1,audio:!1,extensionId:"minllpmhdgpndnkomcoccfekfegnlikg",mediaSource:"application"})).init((function(){s.a.enable(".shareScreenBtn"),R.on("stopScreenSharing",(function(){j(),O("Stop Screen Sharing at"+new Date)})),A.publish(R,(function(e){O("Publish share stream error: "+e),O("getUserMedia failed",e)}))}),(function(e){s.a.enable(".shareScreenBtn"),O("getUserMedia failed",e),j(),Object(d.a)()&&l.a.danger('\n            Please install chrome extension from \n            <a href="https://chrome.google.com/webstore/detail/minllpmhdgpndnkomcoccfekfegnlikg">Google Webstore</a> \n            before using sharing screen.   \n          ',5e3)}))}))}())})),r()(".disableRemoteBtn").on("click",(function(e){if(!(e.currentTarget.classList.contains("disabled")||M.length<=1)){r()(".disableRemoteBtn").toggleClass("off");var t=I.getId();Array.from(document.querySelectorAll(".video-item:not(#video-item-".concat(t,")"))).map((function(e){return"none"===e.style.display?(e.style.display="block",1):(e.style.display="none",0)}))}})),r()(window).resize((function(e){Object(d.c)()?u.a.enterFullScreen():u.a.exitFullScreen(),u.a.customRender(M,w.displayMode,b)})),r()(".ag-container").dblclick((function(e){for(var t=e.target;!t.classList.contains("video-item");)if((t=t.parentNode).classList.contains("ag-main"))return;var n=parseInt(t.id.split("-")[2],10);if(n!==b){var i=2===w.displayMode?f.c:n;L(b,i),y=P(b=i)}u.a.customRender(M,w.displayMode,b)})),r()(document).mousemove((function(t){e._toolbarToggle&&clearTimeout(e._toolbarToggle),r()(".ag-btn-group").addClass("active"),e._toolbarToggle=setTimeout((function(){r()(".ag-btn-group").removeClass("active")}),2500)})),S.on("stream-added",(function(e){var t=e.stream,n=t.getId();_("New stream added: "+n),_((new Date).toLocaleTimeString()),_("Subscribe ",t),n===f.c&&(w.displayMode=2,b=n,y=t,A||s.a.disable(".shareScreenBtn"),s.a.disable([".displayModeBtn",".disableRemoteBtn"])),n!==b&&(2===w.displayMode?S.setRemoteVideoStreamType(t,1):(y&&S.setRemoteVideoStreamType(y,1),y=t,b=n)),S.subscribe(t,(function(e){_("Subscribe stream failed",e)}))})),S.on("peer-leave",(function(e){var t=e.uid;if(_("Peer has left: "+t),_((new Date).toLocaleTimeString()),t===f.c&&(w.displayMode=0,"video"===w.attendeeMode&&s.a.enable(".shareScreenBtn"),s.a.enable([".displayModeBtn",".disableRemoteBtn"]),j()),t===b){var n=2===w.displayMode?f.c:I.getId();L(b,n),y=P(b=n)}x(e.uid)})),S.on("stream-subscribed",(function(e){var t=e.stream;_("Got stream-subscribed event"),_((new Date).toLocaleTimeString()),_("Subscribe remote stream successfully: "+t.getId()),C(t)})),S.on("stream-removed",(function(e){var t=e.stream,n=t.getId();if(_("Stream removed: "+n),_((new Date).toLocaleTimeString()),n===f.c&&(w.displayMode=0,"video"===w.attendeeMode&&s.a.enable(".shareScreenBtn"),s.a.enable([".displayModeBtn",".disableRemoteBtn"]),j()),n===b){var i=2===w.displayMode?f.c:I.getId();L(b,i),y=P(b=i)}x(t.getId())})),B(S,w).then((function(e){var t=Object(d.d)()?{}:{cameraId:w.cameraId,microphoneId:w.microphoneId};I=T(e,w,t),"audience"!==w.attendeeMode&&(b=e,y=I),S.enableDualStream((function(){_("Enable dual stream success!")}),(function(e){_(e)})),I.init((function(){"audience"!==w.attendeeMode&&(C(I,!0),S.publish(I,(function(e){_("Publish local stream error: "+e)})))}),(function(e){_("getUserMedia failed",e)}))}))}.call(this,n(18))},,function(e,t,n){},function(e,t,n){}]);