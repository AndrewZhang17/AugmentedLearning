console.log("Last modification time: 5/17/2021, 3:25:02 PM"),function(e){function t(t){for(var i,r,c=t[0],s=t[1],d=t[2],u=0,f=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(l&&l(t);f.length;)f.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(i=!1)}i&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},o={2:0},a=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var l=s;a.push([23,0]),n()}([,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r}));var i={"120p,120p_1":[160,120,15,65],"360p_4":[640,360,30,600],"480p_4":[640,480,30,750],"720p_3":[1280,720,30,1710]},o=1,a="06d344e526194d0cb27960ab9b38020c",r=null},function(e,t,n){"use strict";var i,o=n(1),a=n.n(o),r=(i=function(e,t){e instanceof Array?e.map((function(e){return t(e)})):t(e)},{hide:function(e){i(e,(function(e){a()(e).hide()}))},show:function(e){i(e,(function(e){a()(e).show()}))},toggle:function(e){i(e,(function(e){a()(e).toggle()}))},enable:function(e){i(e,(function(e){a()(e).removeClass("disabled")}))},disable:function(e){i(e,(function(e){a()(e).addClass("disabled")}))}});t.a=r},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},o=function(){return window.innerWidth<=800&&window.innerHeight<=830},a=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},r=function(){return"undefined"!=typeof InstallTrigger}},function(e,t,n){"use strict";n(26);function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,r=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw r}}}}function a(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}t.a={init:function(e,t,n){this.MAX_RATIO=n,this.MIN_RATIO=t,this.canvas=document.querySelector("#".concat(e))},_checkRatio:function(e,t){var n=t/e;return!(n>this.MAX_RATIO||n<this.MIN_RATIO)},customRender:function(e,t,n){this.canvas.classList.remove("container__flex"),this.canvas.classList.add("container__grid");var i=e.length;n=n||e[e.length-1]&&e[e.length-1].getId(),i>4&&1===t||i>8?(t=0,console.log("Automatically switch to tile mode..."),this.rendererFactory(e,t,n)):this.rendererFactory(e,t,n)},rendererFactory:function(e,t,n){if(0===t)this.tileRenderer(e);else if(1===t)this.pipRenderer(e,n);else{if(2!==t)throw Error("Wrong mode for renderer");this.sharingRenderer(e,n)}},updateVideoItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.getId(),o=document.querySelector("#video-item-"+i);if(!o){o=document.createElement("section");var a=document.createElement("div");o.setAttribute("id","video-item-"+i),o.setAttribute("class","video-item"),a.setAttribute("class","video-item-box"),o.appendChild(a),this.canvas.appendChild(o),e.play("video-item-"+i,{fit:"contain"})}n?o.classList.add("window__fit"):o.classList.remove("window__fit"),o.setAttribute("style",t)},enterFullScreen:function(){this.canvas.classList.add("fullscreen")},exitFullScreen:function(){this.canvas.classList.remove("fullscreen")},tileRenderer:function(e){var t=function(e){for(var t,n,i,o,a,r=e.width,c=e.height,s=e.minRatio,d=e.maxRatio,l=e.count,u=1;u<=l;u++){var f=u,h=Math.ceil(l/u);n=Math.floor((r-5)/h);var m=(i=Math.floor((c-5)/f))/n;m>d?i=(m=d)*n:m<s&&(n=i/(m=s));var p=n*i*l;(void 0===t||p>t)&&(t=p,a=i,o=n)}return{height:a,width:o}}({width:this.canvas.clientWidth,height:this.canvas.clientHeight,minRatio:this.MIN_RATIO,maxRatio:this.MAX_RATIO,count:e.length}),n=t.width,i=t.height;this.canvas.classList.remove("container__grid"),this.canvas.classList.add("container__flex");var a,r=o(e);try{for(r.s();!(a=r.n()).done;){var c=a.value;this.updateVideoItem(c,"width: ".concat(n,"px; height: ").concat(i,"px;"))}}catch(e){r.e(e)}finally{r.f()}},pipRenderer:function(e,t){var n=e.length;if(n>4)throw Error("PIP mode only suitable for less than 4 stream");if(!this._checkRatio(4*this.canvas.clientWidth/24,3*this.canvas.clientHeight/12)||!this._checkRatio(12*this.canvas.clientWidth/24,12*this.canvas.clientHeight/12))return this.tileRenderer(e);for(var i=0,o=0;i<n;i++){var a=e[i];a.getId()===t?this.updateVideoItem(a,"grid-area: span 12/span 24/13/25"):(this.updateVideoItem(a,"grid-area: span 3/span 4/".concat(4+3*o,"/25;\n                    z-index:1;width:calc(100% - 20px);height:calc(100% - 20px)")),o++)}},sharingRenderer:function(e,t){var n=e.length;if(n>8)throw Error("Screen Sharing Mode only suitable for less than 8 stream");if(!this._checkRatio(4*this.canvas.clientWidth/24,4*this.canvas.clientHeight/12)&&1!==e.length){var a=e.findIndex((function(e){return e.getId()===t}));if(-1===a)throw Error("Cannot find stream by given mainId!");for(var r=0;r<n;r++)r!==a&&this.updateVideoItem(e[r],"display: none");return this.sharingRenderer([e[a]],t)}var c=i(e);if(8===n){var s=c.findIndex((function(e){return e.hasAudio()&&!e.hasVideo()}));-1===s&&(s=7);var d=c[s];this.updateVideoItem(d,"display: none"),c.splice(s,1)}var l,u=o(c);try{for(u.s();!(l=u.n()).done;){var f=l.value;f.getId()===t?1===n?this.updateVideoItem(f,"grid-area: span 12/span 24/13/25;",!0):n<5?this.updateVideoItem(f,"grid-area: span 12/span 20/13/25;",!0):this.updateVideoItem(f,"grid-area: span 12/span 16/13/21;",!0):this.updateVideoItem(f,"grid-area: span 4/span 4")}}catch(e){u.e(e)}finally{u.f()}}}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var i=function(e,t,n){console.log("%c ".concat(e,": ").concat(n),"color: ".concat(t))},o={init:function(e,t){return function(n){return i(e,t,n)}}}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,i=new Array(n);n--;)i[n]=[t[n],e[t[n]]];return i})},,,,function(e,t,n){"use strict";var i=n(1),o=n.n(i),a=function(){var e=o()(".notification-container");e.length||(o()("body").append('<div class="notification-container" \n                    style="z-index: 12;position: absolute;\n                    width: 38.2%;max-width: 450px; \n                    min-width: 300px;left: 0;\n                    word-break:break-all;\n                    bottom: 0;"></div>'),e=o()(".notification-container"));var t=function(t,n,i){var a=(new Date).getTime(),r='<div id="notify-'.concat(a,'" class="notification is-').concat(t,'">\n                                <button class="delete"></button>\n                                ').concat(n,"\n                            </div>");e.append(r),o()("#notify-"+a+" .delete").on("click",(function(){o()("#notify-"+a).remove()})),setTimeout((function(){o()("#notify-"+a).remove()}),i)};return{primary:function(e,n){t("primary",e,n)},link:function(e,n){t("link",e,n)},info:function(e,n){t("info",e,n)},success:function(e,n){t("success",e,n)},warning:function(e,n){t("warning",e,n)},danger:function(e,n){t("danger",e,n)}}}();t.a=a},,,function(e,t,n){"use strict";n.r(t),function(e){var t=n(7),i=n.n(t),o=(n(17),n(1)),a=n.n(o),r=n(3),c=n(19),s=(n(14),n(15),n(25),n(5)),d=n(8),l=n(20),u=n(9),f=n(4),h=n(13),m=(n(16),n(12));n(27),n(35);function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,a=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}m.a.initializeApp({apiKey:"AIzaSyDOCwPfl_GsC-PKTDQmZxyAaBuvxnHDo7U",authDomain:"augmentedteaching-ea1ff.firebaseapp.com",databaseURL:"https://augmentedteaching-ea1ff-default-rtdb.firebaseio.com",projectId:"augmentedteaching-ea1ff",storageBucket:"augmentedteaching-ea1ff.appspot.com",messagingSenderId:"984963266408",appId:"1:984963266408:web:2f005bfe04d93b781188dd"});m.a.database();var v=m.a.storage(),b=0;function y(e,t){m.a.database().ref("clicks/").push({offsetX:e,offsetY:t})}var w,S,I={},M={},R={},A=[],k=null,_=null,O=h.b.init("global","blue"),j=h.b.init("share","yellow"),B=h.b.init("local","green");m.a.database().ref("upload/").on("child_added",(function(e){var t=e.val();if(B(t),b===t){B("POGGERS");var n=v.ref("images/"+b+".png"),i=v.ref("CH4.obj");n.getDownloadURL().then((function(e){B(e),window.open(e,"_blank")})).catch((function(e){B(e)})),i.getDownloadURL().then((function(e){B(e),window.open(e,"_blank")})).catch((function(e){B(e)}))}}));var T=function(e,t){return new Promise((function(n,i){e.init(t.key,(function(){O("AgoraRTC client initialized");var o=f.b[t.videoProfileLow];e.join(t.token,t.channel,t.uid,(function(t){Object(h.a)(t,"brown","User ".concat(t," join channel successfully")),Object(h.a)(t,"brown",(new Date).toLocaleTimeString()),e.setLowStreamParameter({width:o[0],height:o[1],framerate:o[2],bitrate:o[3]}),n(t)}),(function(e){i(e)}))}))}))},x=function(e,t,n){var o={streamID:e,audio:!0,video:!0,screen:!1};switch(t.attendeeMode){case"audio-only":o.video=!1;break;case"audience":o.video=!1,o.audio=!1;break;default:case"video":}var a=i.a.createStream(Object(c.merge)(o,n));return a.setVideoProfile(t.videoProfile),a},C=function(){try{k&&k.unpublish(_),_&&_.close(),k&&k.leave((function(){j("Share client succeed to leave.")}),(function(){j("Share client failed to leave.")}))}finally{k=null,_=null}};window.installSuccess=function(){O.apply(void 0,arguments)},window.installError=function(){O.apply(void 0,arguments),l.a.danger("Failed to install the extension, please check the network and console.",3e3)};var L=function(e){A.map((function(t,n){return t.getId()===e?(A[n].close(),a()("#video-item-"+e).remove(),A.splice(n,1),1):0})),A.length<=4&&2!==I.displayMode&&s.a.enable(".displayModeBtn"),u.a.customRender(A,I.displayMode,w)},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getId(),i=A.some((function(e){return e.getId()===n}));i||(t?A.push(e):A.unshift(e),A.length>4&&(I.displayMode=1===I.displayMode?0:I.displayMode,s.a.disable([".displayModeBtn",".disableRemoteBtn"])),u.a.customRender(A,I.displayMode,w),a()("video").on("click",(function(e){var t=e.target.videoWidth/e.target.videoHeight;t>1?y((e.offsetX-e.target.offsetWidth/2)/e.target.offsetWidth,(e.offsetY-e.target.offsetHeight/2)/(e.target.offsetWidth/t)):y((e.offsetX-e.target.offsetWidth/2)/(e.target.offsetHeight*t),(e.offsetY-e.target.offsetHeight/2)/e.target.offsetHeight)})))},V=function(e){return A.filter((function(t){return t.getId()===e}))[0]},D=function(e,t){if(e!==t){var n,i,o,a=p(A);try{for(a.s();!(o=a.n()).done;){var r=o.value,c=r.getId();c===e?n=r:c===t&&(i=r)}}catch(e){a.e(e)}finally{a.f()}n&&M.setRemoteVideoStreamType(n,1),i&&M.setRemoteVideoStreamType(i,0)}};(function(e){switch(document.querySelector(".ag-header-lead span").innerHTML="AgoraWeb v".concat("^2.5.2".slice(1)),u.a.init("ag-canvas",9/16,1.6),Object(d.c)()&&u.a.enterFullScreen(),Object(d.b)()||Object(d.a)()||s.a.disable(".shareScreenBtn"),a()("#room-name").html(e.channel),e.attendeeMode){case"audio-only":s.a.hide([".videoControlBtn",".shareScreenBtn"]);break;case"audience":s.a.hide([".videoControlBtn",".audioControlBtn",".shareScreenBtn"]);break;default:case"video":}})(I=function(){var e={videoProfile:"720p_3",videoProfileLow:r.get("videoProfileLow"),cameraId:r.get("cameraId"),microphoneId:r.get("microphoneId"),channel:r.get("channel")||"test",transcode:r.get("transcode")||"interop",attendeeMode:r.get("attendeeMode")||"video",baseMode:r.get("baseMode")||"avc",displayMode:1,uid:void 0,resolution:void 0},t=f.b[r.get("videoProfile")];return e.resolution=t[0]/t[1]||4/3,e.key=f.a,e.token=f.d,e}()),M=i.a.createClient({mode:I.transcode}),a()(".displayModeBtn").on("click",(function(e){e.currentTarget.classList.contains("disabled")||A.length<=1||(1===I.displayMode?(I.displayMode=0,s.a.disable(".disableRemoteBtn")):0===I.displayMode&&(I.displayMode=1,s.a.enable(".disableRemoteBtn")),u.a.customRender(A,I.displayMode,w))})),a()(".saveFrame").on("click",(function(){var e=Date.now();m.a.database().ref("save/").push(e),b=e})),a()(".exitBtn").on("click",(function(){try{k&&C(),M&&M.unpublish(R),R&&R.close(),M&&M.leave((function(){B("Client succeed to leave.")}),(function(){B("Client failed to leave.")}))}finally{window.location.href="index.html"}})),a()(".videoControlBtn").on("click",(function(){a()(".videoControlBtn").toggleClass("off"),R.isVideoOn()?R.disableVideo():R.enableVideo()})),a()(".audioControlBtn").on("click",(function(){a()(".audioControlBtn").toggleClass("off"),R.isAudioOn()?R.disableAudio():R.enableAudio()})),a()(".shareScreenBtn").on("click",(function(e){e.currentTarget.classList.contains("disabled")||(k?C():function(){s.a.disable(".shareScreenBtn"),k=i.a.createClient({mode:I.transcode});var e=Object(c.merge)(I,{uid:f.c});T(k,e).then((function(t){(_=x(t,e,{screen:!0,video:!1,audio:!1,extensionId:"minllpmhdgpndnkomcoccfekfegnlikg",mediaSource:"application"})).init((function(){s.a.enable(".shareScreenBtn"),_.on("stopScreenSharing",(function(){C(),j("Stop Screen Sharing at"+new Date)})),k.publish(_,(function(e){j("Publish share stream error: "+e),j("getUserMedia failed",e)}))}),(function(e){s.a.enable(".shareScreenBtn"),j("getUserMedia failed",e),C(),Object(d.a)()&&l.a.danger('\n            Please install chrome extension from \n            <a href="https://chrome.google.com/webstore/detail/minllpmhdgpndnkomcoccfekfegnlikg">Google Webstore</a> \n            before using sharing screen.   \n          ',5e3)}))}))}())})),a()(".disableRemoteBtn").on("click",(function(e){if(!(e.currentTarget.classList.contains("disabled")||A.length<=1)){a()(".disableRemoteBtn").toggleClass("off");var t=R.getId();Array.from(document.querySelectorAll(".video-item:not(#video-item-".concat(t,")"))).map((function(e){return"none"===e.style.display?(e.style.display="block",1):(e.style.display="none",0)}))}})),a()(window).resize((function(e){Object(d.c)()?u.a.enterFullScreen():u.a.exitFullScreen(),u.a.customRender(A,I.displayMode,w)})),a()(".ag-container").dblclick((function(e){for(var t=e.target;!t.classList.contains("video-item");)if((t=t.parentNode).classList.contains("ag-main"))return;var n=parseInt(t.id.split("-")[2],10);if(n!==w){var i=2===I.displayMode?f.c:n;D(w,i),S=V(w=i)}u.a.customRender(A,I.displayMode,w)})),a()(document).mousemove((function(t){e._toolbarToggle&&clearTimeout(e._toolbarToggle),a()(".ag-btn-group").addClass("active"),e._toolbarToggle=setTimeout((function(){a()(".ag-btn-group").removeClass("active")}),2500)})),M.on("stream-added",(function(e){var t=e.stream,n=t.getId();B("New stream added: "+n),B((new Date).toLocaleTimeString()),B("Subscribe ",t),n===f.c&&(I.displayMode=2,w=n,S=t,k||s.a.disable(".shareScreenBtn"),s.a.disable([".displayModeBtn",".disableRemoteBtn"])),n!==w&&(2===I.displayMode?M.setRemoteVideoStreamType(t,1):(S&&M.setRemoteVideoStreamType(S,1),S=t,w=n)),M.subscribe(t,(function(e){B("Subscribe stream failed",e)}))})),M.on("peer-leave",(function(e){var t=e.uid;if(B("Peer has left: "+t),B((new Date).toLocaleTimeString()),t===f.c&&(I.displayMode=0,"video"===I.attendeeMode&&s.a.enable(".shareScreenBtn"),s.a.enable([".displayModeBtn",".disableRemoteBtn"]),C()),t===w){var n=2===I.displayMode?f.c:R.getId();D(w,n),S=V(w=n)}L(e.uid)})),M.on("stream-subscribed",(function(e){var t=e.stream;B("Got stream-subscribed event"),B((new Date).toLocaleTimeString()),B("Subscribe remote stream successfully: "+t.getId()),P(t)})),M.on("stream-removed",(function(e){var t=e.stream,n=t.getId();if(B("Stream removed: "+n),B((new Date).toLocaleTimeString()),n===f.c&&(I.displayMode=0,"video"===I.attendeeMode&&s.a.enable(".shareScreenBtn"),s.a.enable([".displayModeBtn",".disableRemoteBtn"]),C()),n===w){var i=2===I.displayMode?f.c:R.getId();D(w,i),S=V(w=i)}L(t.getId())})),T(M,I).then((function(e){var t=Object(d.d)()?{}:{cameraId:I.cameraId,microphoneId:I.microphoneId};R=x(e,I,t),"audience"!==I.attendeeMode&&(w=e,S=R),M.enableDualStream((function(){B("Enable dual stream success!")}),(function(e){B(e)})),R.init((function(){"audience"!==I.attendeeMode&&(P(R,!0),M.publish(R,(function(e){B("Publish local stream error: "+e)})))}),(function(e){B("getUserMedia failed",e)}))}))}.call(this,n(18))},,function(e,t,n){},function(e,t,n){}]);